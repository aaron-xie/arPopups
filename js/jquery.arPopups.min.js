/*
 *   jquery.arPopups.js
 *  ===========================
 *   v1.2.8 [2013.05.16]
 *  ===========================
 *   power by Aaron 
 *   Aaron.xiexie@gmail.com
 */
;(function(a){var b;a.fn.extend({arPopups:function(c){var d={imgURL:"images/",trigger:"click",popwrap:"",overlay:.5,callback:null,afterClose:null,position:"center",timeout:0,url:null,filter:null,requestType:null,requestData:null,poptype:"dialog",poptitle:"arPopups Title",drag:true,popsize:null,html:""};var e=a.extend({},d,a.arPopups.param,c);var f=this;var g=a(window);var h=a("body");var i,j;var k='<div class="arpopups'+(a.trim(e.popwrap)?" "+e.popwrap:"")+'">\n'+'<div class="arp-close"><span>Close</span></div>\n'+(!e.poptitle?'':'<div class="arp-title"><span>'+e.poptitle+'</span></div>\n')+'<div class="arp-content"/>\n'+'</div>';function l(){if(e.overlay>0){if(!b){h.append('<div class="arp-overlay"/>');b=a('div.arp-overlay');}else{h.append(b)};b.fadeIn(300).dblclick(function(){q(a("div.arpopups"),e.afterClose)})};if(!j)j=a(k);h.append(j);if(e.filter){j.attr("id","arp_"+e.filter.substring(1))};if(a.browser.msie&&a.browser.version.substr(0,1)<7){if(b)a('<iframe src="javascript:false;document.write(\'\');" class="ie6iframe"></iframe>').css({opacity:0}).appendTo(b);a.getScript(imgURL+"DD_belatedPNG.js",function(){DD_belatedPNG.fix('.ie6png')});j.find("div.arp-close").addClass("ie6png");};return m()};function m(){var r=j.find("div.arp-content");var s=j.find('div.arp-title');if(e.url){var t=e.url.substring(0,1)==="@"?f.attr(e.url.substring(1)):e.url;if(e.requestType&&a.inArray(e.requestType,['iframe','ajax','img'])!=-1){r.html('<div id="ajaxLoading"><img src="'+e.imgURL+'loading.gif" /></div>');if(e.requestType==="img"){var u=new Image();u.src=t;if(u.complete){r.empty()[0].appendChild(u);return n()};u.onload=function(){r.empty()[0].appendChild(u);return n()}}else if(e.requestType==="ajax"){if(e.requestData!=null){a.get(t,e.requestData,function(u){r.html(u);return n()},e.requestData.dataType)}else{r.load(t+[e.filter!=null?" "+e.filter:""],n)}}else{ifr=a('<iframe name="arIframe" scrolling="auto" frameborder="0"/>');ifr.appendTo(r.empty()).attr("src",t).load(function(){if(e.popsize!=null){ifr.css({width:e.popsize.width-parseInt(r.css("padding-left"))*2,height:e.popsize.height?e.popsize.height-s.outerHeight()-parseInt(r.css("padding-top"))*2:g.height()/2})}else{var u=a(this).contents();var v=u.height();var w=u.width();var x=Math.min(g.width()-40,w);var y=g.height()-25-(!e.poptitle?0:30);y=Math.min(y,v);if(!y){return};a(this).css({height:y,width:x})};return n()})}}else{a(t).clone(true).show().appendTo(r.empty());return n()}}else if(e.html){r.html(e.html);return n()}else{f.clone(true).appendTo(r.empty()).show();return n()}};function n(){o();g.resize(o);if(b){h.css({overflow:"hidden"});if(a.browser.msie&&a.browser.version.substr(0,1)<8)a("html").css({"overflow-y":"hidden"})};j.show().find('.arp-close').click(function(){return q(j,e.afterClose)||false;});a(document).unbind('keydown.arpop').bind('keydown.arpop',function(r){if(r.keyCode===27)q(j,e.afterClose);return true});if(e.poptitle&&e.drag)p();if(e.timeout){i=setTimeout(function(){q(j,e.afterClose)},e.timeout)};if(a.browser.msie&&a.browser.version.substr(0,1)<7){a("input:text,input:password").addClass("input-txt")};if(typeof(e.callback)==='function')return e.callback(f,j)};function o(){if(!j[0])return false;var r=Math.max(h.height(),g.height());if(b){b.css({width:'100%',height:r,opacity:e.overlay})};if(e.popsize){j.css({width:e.popsize.width,height:e.popsize.height})};var s={};if(e.position=="center"){s["left"]=g.scrollLeft()+(g.width()-j.outerWidth())/2;s["top"]=g.scrollTop()+(g.height()-j.outerHeight())/2}else{for(var t in e.position){s[t]=e.position[t]}};j.css(s)};function p(){var r,s,t;var u=j.find('div.arp-title').css('cursor','move');u.bind("selectstart",function(){return false});u.mousedown(function(y){r=y.clientX-parseInt(j.css("left"));s=y.clientY-parseInt(j.css("top"));j.mousemove(v).mouseout(w).css('opacity',0.8);u.mouseup(x)});function v(y){t=false;if(y.clientX-r<0){l=0}else if(y.clientX-r>g.width()-j.width()){l=g.width()-j.width()}else{l=y.clientX-r};j.css({left:l,top:y.clientY-s})};function w(y){t=true;setTimeout(function(){t&&x(y)},10)};function x(y){j.unbind("mousemove",v).unbind("mouseout",w).css('opacity',1);u.unbind("mouseup",x)}};function q(r,s){var t=r||j;if(!t[0])return false;if(i)clearTimeout(i);if(b&&t.length>=a("div.arpopups").length){b.remove();h.css({overflow:"auto"});if(a.browser.msie&&a.browser.version.substr(0,1)<8)a("html").css({"overflow-y":"auto"})};t.stop().fadeOut(300,function(){t.remove();if(typeof(s)==="function")s()})};if(e.trigger=="auto"){l()}else{f[e.trigger](function(){return l()||false;})};a.arPopups.close=q;return this;}});a.arPopups={param:{},defaults:function(c){a.extend(a.arPopups.param,c)}}})(jQuery);